{
  "hash": "ec2d7b6f187a506c42e54bb1e728e5fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Manuscript Figure and Supplemental\"\ncode-fold: true\nfig-dpi: 600\n---\n\n\n\n\nThis is the final figure and Supplemental material for the manuscript.\n\n## Setup \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(tidyverse)\nlibrary(patchwork)\nlibrary(ggspatial)\nlibrary(sf)\nlibrary(rnaturalearth)\nlibrary(ggthemes)\nlibrary(openxlsx)\nlibrary(gt)\n\n\nsource(\"XX_functions.R\")\n\n# Metrics\nv <- read_csv(\"Data/Datasets/vultures_final.csv\") |>\n  # Round non-integer values of population counts\n  mutate(across(c(contains(\"pop\"), contains(\"raw\")), round)) \n\n# Raw counts\nraw <- read_csv(\"Data/Datasets/vultures_clean_2023.csv\")\n\n# Predicted GAM models\npred <- read_csv(\"Data/Datasets/vultures_gams_pred.csv\")\n\n# Checking problematic years\nsupp <- read_csv(\"Data/Datasets/table_supplemental.csv\")\n```\n:::\n\n\n\n\n\n## Main figure\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <- v |> \n  mutate(date = as_date(p50_doy) - days(1))\n\ng1 <- ggplot(v, aes(x = year, y = date)) +\n  theme_bw() +\n  theme(axis.title.x = element_blank()) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = TRUE) +\n  labs(y = \"Date of peak migration\", x = \"\")\n\ng2 <- ggplot(v, aes(x = year, y = mig_raw_max)) +\n  theme_bw() +\n  geom_point() +\n  stat_smooth(method = MASS::glm.nb) +\n  labs(y = \"Annual maximum\\nDaily Estimated Total\", x = \"Year\")\n\ng <- g1 / g2 + plot_annotation(tag_levels = \"A\")\n#ggsave(\"fig1_quick.png\", dpi = 1000, width = 8, height = 7)\n\ngg <- g1 / (g2 + labs(y = \"Annual maximum DET\")) + plot_annotation(tag_levels = \"A\")\n```\n:::\n\n\n\n\n\n\nDouble checking growth and increases\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- MASS::glm.nb(mig_raw_max ~ year, data = v)\n\nd <- select(v, year) |>\n  mutate(y = predict(m, v),\n         yexp = exp(y))\n\n# Compound growth (avg growth over the period)\n(1251 / 451)^ (1/25) - 1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.04165339\n```\n\n\n:::\n\n```{.r .cell-code}\n# Compound interest (amount at the end)\n451 * (1 + 0.041647)^(25)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1250.808\n```\n\n\n:::\n\n```{.r .cell-code}\n# Factor of increase\n1251/451\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.773836\n```\n\n\n:::\n:::\n\n\n\n\n\n### Big version\n\n**With two y-axis options for panel B**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-5-1.png){width=4800}\n:::\n\n```{.r .cell-code}\ngg\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-5-2.png){width=4800}\n:::\n:::\n\n\n\n\n### Small version\n**With two y-axis options for panel B**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-6-1.png){width=80%}\n:::\n\n```{.r .cell-code}\ngg\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-6-2.png){width=80%}\n:::\n:::\n\n\n\n\n## Map\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bcmaps)\nlibrary(ggrepel)\nne_download(type = \"populated_places\", scale = \"large\", load = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"ne_10m_populated_places\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncities <- bcmaps::bc_cities(ask = FALSE) |> \n  select(NAME) |>\n  filter(NAME %in% c(\"Victoria\", \"Vancouver\", \"Nanaimo\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nbc_cities was updated on 2024-07-10\n```\n\n\n:::\n\n```{.r .cell-code}\ncities <- ne_load(file_name = \"ne_10m_populated_places\") |> \n  filter(NAME %in% c(\"Seattle\", \"Portland\"), ADM1NAME %in% c(\"Oregon\", \"Washington\")) |>\n  select(NAME) |> \n  st_transform(st_crs(cities)) |>\n  bind_rows(cities) |>\n  rename(name = NAME)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `ne_10m_populated_places' from data source \n  `/home/steffi/R_tmpdir/RtmpTPJOlj/ne_10m_populated_places.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 7342 features and 137 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -179.59 ymin: -90 xmax: 179.3833 ymax: 82.48332\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\nstn <- c(-123.55082035835214, 48.31773308537152) |>\n  st_point() |>\n  st_sfc(crs = 4326) |>\n  st_sf(name = \"Rocky Point\") |>\n  st_transform(st_crs(cities))\n\nland <- data.frame(lon = c(-124.3, -124.3, -123.5),\n                   lat = c(48.39, 48.75, 49.2),\n                   name = c(\"Juan de Fuca Strait\", \"Vancouver Island\", \"Salish Sea\")) |>\n  st_as_sf(coords = c(\"lon\", \"lat\"), crs = 4326)\n\narea <- ne_states(country = c(\"Canada\", \"United States of America\")) |>\n  #st_crop(st_bbox(c(xmin = -140, xmax = -112, ymin = 41, ymax = 60))) |>\n  #filter(name %in% c(\"British Columbia\", \"Alberta\", \"Washington\", \"Oregon\", \"Idaho\", \"Montana\")) |>\n  mutate(name = if_else(name %in% c(\"British Columbia\", \"Washington\", \"Oregon\"), toupper(name), NA),\n         name = str_replace(name, \" \", \"\\n\"),\n         postal =  if_else(postal %in% c(\"BC\", \"WA\", \"OR\", \"AB\"), postal, NA))\n\nbox <- st_polygon(list(rbind(c(1050000, 330000), \n                             c(1050000, 490000),\n                             c(1230000, 490000),\n                             c(1230000, 330000),\n                             c(1050000, 330000)))) |>\n  st_sfc(crs = 3005)\n\ng0 <- ggplot(data = area, aes(label = name)) +\n  theme_map() +\n  theme(panel.border = element_rect(fill = NA), \n        plot.margin = unit(c(0,0,0,0), units = \"mm\"),\n        panel.spacing = unit(0, units = \"mm\")) +\n  scale_x_continuous(expand = c(0,0)) +\n  scale_y_continuous(expand = c(0,0)) +\n  geom_sf()\n  \ng <- g0 +\n  geom_sf(data = stn, size = 3) +\n  geom_sf_text(data = stn, lineheight = 0.85, nudge_y = -8000) +\n  geom_sf(data = cities) +\n  geom_sf_text(data = cities, hjust = 1.1, nudge_y = 5000) +\n  geom_sf_text(data = land, angle = c(-24, 0, -45), colour = \"grey60\", size = c(6, 7, 7)) +\n  annotation_scale(location = \"bl\") + \n  annotation_north_arrow(\n    location = \"br\", height = unit(0.5, \"cm\"), width = unit(0.5, \"cm\"),\n    style = north_arrow_orienteering(text_size = -Inf)) +\n  coord_sf(crs = 3005, xlim = c(1050000, 1230000), ylim = c(330000, 490000))\n\ng_inset <- g0 +\n  theme(panel.background = element_rect(fill = \"white\")) +\n  geom_sf_text(aes(label = postal), colour = \"black\", size = 3) +\n  geom_sf(data = box, fill = NA, linewidth = 0.5, colour = \"black\", inherit.aes = FALSE) +\n  coord_sf(crs = 3005, xlim = c(500000, 2000000), ylim = c(-200000, 1370000))\n```\n:::\n\n\n\n\n### Big\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng + inset_element(g_inset, left = 0, top = 1, bottom = 0.6, right = 0.342, align_to = \"full\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 60 rows containing missing values or values outside the scale range\n(`geom_text()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-8-1.png){width=5400}\n:::\n:::\n\n\n\n\n\n### Small \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng + inset_element(g_inset, left = 0, top = 1, bottom = 0.6, right = 0.342, align_to = \"full\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 60 rows containing missing values or values outside the scale range\n(`geom_text()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-9-1.png){width=3450}\n:::\n:::\n\n\n\n\n\n\n\n## Supplemental Figure\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred <- mutate(pred, ci95_upper = count + se * 1.96, ci95_lower = count - se * 1.96)\nres <- filter(v, year == 1998) |>\n  mutate(xmin = 204, \n         xmax = 240, y = 0.25 * mig_raw_max, \n         xmid = (240-204)/2 + 204,\n         y = 0.25 * mig_raw_max,\n         height = 0.03 * mig_raw_max, label = \"Resident period\")\n\ng0 <- ggplot() +\n  theme_void() +\n  annotate(geom = \"text\", label = c(\"Migration\\nstart\", \"Peak\\nstart\", \"Peak\", \"Peak\\nend\", \"Migration\\nend\"), \n           y = -0.25, x = c(0, 0.7, 1.3, 1.6, 2), size = 3, lineheight = 0.85) +\n  annotate(geom = \"text\", label = c(\"5%\", \"25%\", \"50%\", \"75%\", \"95%\"), y = 0.25, x = c(0, 0.7, 1.3, 1.6, 2), size = 3) +\n  annotate(geom = \"segment\", y = 0, x = 0, xend = 2, arrow = arrow(angle = 90, ends = \"both\", length = unit(1, \"mm\"))) +\n  annotate(geom = \"segment\", y = 0, x = 0.7, xend = 1.6, linewidth = 4) +\n  annotate(geom = \"segment\", x = 1.29, xend = 1.30, y = 0, linewidth = 8) +\n  ylim(c(-0.5, 0.5)) +\n  xlim(c(-0.1, 2.1))\n\ng1 <- ggplot(data = pred, mapping = aes(x = doy, y = count)) +\n  theme_bw() +\n  geom_ribbon(aes(ymin = ci95_lower, ymax = ci95_upper), fill = \"grey50\", alpha = 0.5) +\n  geom_point(data = raw, na.rm = TRUE, size = 0.5) +\n  geom_line() +\n  geom_errorbarh(data = res, aes(xmin = xmin, xmax = xmax, y = y, height = height), \n                 colour = \"grey70\", inherit.aes = FALSE) +\n  geom_text(data = res, aes(x = xmid, y = y, label = label), vjust = -0.5, inherit.aes = FALSE,\n            size = 3, colour = \"grey30\") +\n  geom_segment(data = v, aes(x = p50_doy, xend = p50_doy + 1, y = -(0.07 * mig_raw_max)), \n               linewidth = 4, inherit.aes = FALSE) +\n  geom_errorbarh(data = v, aes(y = -(0.07 * mig_raw_max), \n                               xmin = mig_start_doy, \n                               xmax = mig_end_doy, \n                               height = 0.07 * mig_raw_max), inherit.aes = FALSE) +\n  geom_segment(data = v, aes(y = -(0.07 * mig_raw_max), x = peak_start_doy, xend = peak_end_doy), linewidth = 2, inherit.aes = FALSE) +\n  scale_x_continuous(name = \"Date\", limits = c(203, 295), \n                     labels = \\(x) format(as_date(x), \"%b %d\"), \n                     n.breaks = 7) +\n  labs(y = \"Daily Estimated Total\") + \n  facet_wrap(~ year, scales = \"free_y\", ncol = 4)\n```\n:::\n\n\n\n\n### Big\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 + inset_element(g0, left = 0.55, right = 0.95, bottom = 0, top = 0.1)\n```\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-11-1.png){width=7200}\n:::\n:::\n\n\n\n\n### Small\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng1 + inset_element(g0, left = 0.55, right = 0.95, bottom = 0, top = 0.1)\n```\n\n::: {.cell-output-display}\n![](04_figures_files/figure-html/unnamed-chunk-12-1.png){width=7200}\n:::\n:::\n\n\n\n\n## Supplemental Table\n\nPresented here for the record, but use exported XLSX version for submission.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt <- supp |> \n  filter(!str_detect(term, \"(I|i)ntercept\"),\n         !str_detect(model, \"(max_doy)|(pop_max)\")) |>\n  mutate(across(where(is.numeric), \\(x) round(x, 3))) |>\n  mutate(p_value = if_else(p_value <= 0.05, \n                           paste0(\"**\", format(p_value, nsmall = 3), \"**\"),\n                           format(p_value, nsmall = 3)),\n         value = paste0(format(estimate, nsmall = 3), \" (P = \", p_value, \")\"),\n         value = str_trim(value)) |>\n  select(Model = model, value, type) |>\n  mutate(type = str_replace(type, \"_\", \" \"),\n         type = str_to_title(type)) |>\n  pivot_wider(names_from = \"type\", values_from = \"value\")\n\ngt(t) |>\n  gt_theme() |>\n  fmt_markdown() |>\n  fmt_number(columns = -1, decimals = 3)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fwbegcjacr\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fwbegcjacr table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fwbegcjacr thead, #fwbegcjacr tbody, #fwbegcjacr tfoot, #fwbegcjacr tr, #fwbegcjacr td, #fwbegcjacr th {\n  border-style: none;\n}\n\n#fwbegcjacr p {\n  margin: 0;\n  padding: 0;\n}\n\n#fwbegcjacr .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 80%;\n  border-top-style: solid;\n  border-top-width: 3px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fwbegcjacr .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fwbegcjacr .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fwbegcjacr .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 3px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fwbegcjacr .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fwbegcjacr .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fwbegcjacr .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fwbegcjacr .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 3px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fwbegcjacr .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fwbegcjacr .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fwbegcjacr .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fwbegcjacr .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fwbegcjacr .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fwbegcjacr .gt_row {\n  padding-top: 7px;\n  padding-bottom: 7px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fwbegcjacr .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbegcjacr .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fwbegcjacr .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fwbegcjacr .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fwbegcjacr .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbegcjacr .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fwbegcjacr .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbegcjacr .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fwbegcjacr .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbegcjacr .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwbegcjacr .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwbegcjacr .gt_left {\n  text-align: left;\n}\n\n#fwbegcjacr .gt_center {\n  text-align: center;\n}\n\n#fwbegcjacr .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fwbegcjacr .gt_font_normal {\n  font-weight: normal;\n}\n\n#fwbegcjacr .gt_font_bold {\n  font-weight: bold;\n}\n\n#fwbegcjacr .gt_font_italic {\n  font-style: italic;\n}\n\n#fwbegcjacr .gt_super {\n  font-size: 65%;\n}\n\n#fwbegcjacr .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fwbegcjacr .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fwbegcjacr .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fwbegcjacr .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fwbegcjacr .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fwbegcjacr .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fwbegcjacr .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Model\">Model</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Original\">Original</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Gaps Removed\">Gaps Removed</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"End Removed\">End Removed</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"All Removed\">All Removed</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"mig_start_doy ~ year\"><div class='gt_from_md'><p>mig_start_doy ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.176 (P = **0.017**)\"><div class='gt_from_md'><p>0.176 (P = <strong>0.017</strong>)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.191 (P = **0.016**)\"><div class='gt_from_md'><p>0.191 (P = <strong>0.016</strong>)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.166 (P = **0.037**)\"><div class='gt_from_md'><p>0.166 (P = <strong>0.037</strong>)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.180 (P = **0.041**)\"><div class='gt_from_md'><p>0.180 (P = <strong>0.041</strong>)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"peak_start_doy ~ year\"><div class='gt_from_md'><p>peak_start_doy ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.155 (P = **0.005**)\"><div class='gt_from_md'><p>0.155 (P = <strong>0.005</strong>)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.163 (P = **0.003**)\"><div class='gt_from_md'><p>0.163 (P = <strong>0.003</strong>)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.155 (P = **0.014**)\"><div class='gt_from_md'><p>0.155 (P = <strong>0.014</strong>)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.165 (P = **0.012**)\"><div class='gt_from_md'><p>0.165 (P = <strong>0.012</strong>)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"p50_doy ~ year\"><div class='gt_from_md'><p>p50_doy ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.147 (P = **0.009**)\"><div class='gt_from_md'><p>0.147 (P = <strong>0.009</strong>)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.157 (P = **0.005**)\"><div class='gt_from_md'><p>0.157 (P = <strong>0.005</strong>)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.151 (P = **0.024**)\"><div class='gt_from_md'><p>0.151 (P = <strong>0.024</strong>)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.165 (P = **0.015**)\"><div class='gt_from_md'><p>0.165 (P = <strong>0.015</strong>)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"peak_end_doy ~ year\"><div class='gt_from_md'><p>peak_end_doy ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.132 (P = **0.016**)\"><div class='gt_from_md'><p>0.132 (P = <strong>0.016</strong>)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.140 (P = **0.008**)\"><div class='gt_from_md'><p>0.140 (P = <strong>0.008</strong>)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.128 (P = **0.043**)\"><div class='gt_from_md'><p>0.128 (P = <strong>0.043</strong>)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.138 (P = **0.027**)\"><div class='gt_from_md'><p>0.138 (P = <strong>0.027</strong>)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"mig_end_doy ~ year\"><div class='gt_from_md'><p>mig_end_doy ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.093 (P = 0.263)\"><div class='gt_from_md'><p>0.093 (P = 0.263)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.091 (P = 0.324)\"><div class='gt_from_md'><p>0.091 (P = 0.324)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.077 (P = 0.402)\"><div class='gt_from_md'><p>0.077 (P = 0.402)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.073 (P = 0.480)\"><div class='gt_from_md'><p>0.073 (P = 0.480)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"mig_dur_days ~ year\"><div class='gt_from_md'><p>mig_dur_days ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"-0.083 (P = 0.394)\"><div class='gt_from_md'><p>-0.083 (P = 0.394)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.100 (P = 0.365)\"><div class='gt_from_md'><p>-0.100 (P = 0.365)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.089 (P = 0.394)\"><div class='gt_from_md'><p>-0.089 (P = 0.394)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.107 (P = 0.382)\"><div class='gt_from_md'><p>-0.107 (P = 0.382)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"peak_dur_days ~ year\"><div class='gt_from_md'><p>peak_dur_days ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"-0.023 (P = 0.476)\"><div class='gt_from_md'><p>-0.023 (P = 0.476)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.023 (P = 0.508)\"><div class='gt_from_md'><p>-0.023 (P = 0.508)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.028 (P = 0.420)\"><div class='gt_from_md'><p>-0.028 (P = 0.420)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"-0.027 (P = 0.469)\"><div class='gt_from_md'><p>-0.027 (P = 0.469)</p>\n</div></div></td></tr>\n    <tr><td headers=\"Model\" class=\"gt_row gt_left\"><div data-qmd=\"mig_raw_max ~ year\"><div class='gt_from_md'><p>mig_raw_max ~ year</p>\n</div></div></td>\n<td headers=\"Original\" class=\"gt_row gt_left\"><div data-qmd=\"0.041 (P = **0.000**)\"><div class='gt_from_md'><p>0.041 (P = <strong>0.000</strong>)</p>\n</div></div></td>\n<td headers=\"Gaps Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.040 (P = **0.000**)\"><div class='gt_from_md'><p>0.040 (P = <strong>0.000</strong>)</p>\n</div></div></td>\n<td headers=\"End Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.034 (P = **0.002**)\"><div class='gt_from_md'><p>0.034 (P = <strong>0.002</strong>)</p>\n</div></div></td>\n<td headers=\"All Removed\" class=\"gt_row gt_left\"><div data-qmd=\"0.032 (P = **0.009**)\"><div class='gt_from_md'><p>0.032 (P = <strong>0.009</strong>)</p>\n</div></div></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\nt <- supp |> \n  filter(!str_detect(term, \"(I|i)ntercept\")) |>\n  mutate(across(where(is.numeric), \\(x) round(x, 3))) |>\n  select(model, type, estimate, p_value) |>\n  pivot_wider(names_from = \"type\", values_from = c(\"estimate\", \"p_value\"),\n              names_glue = \"{type}_{.value}\") |>\n  select(model, contains(\"original\"), contains(\"gaps\"), contains(\"end\"), contains(\"all\")) |>\n  rename(\"Model\" = \"model\",\n         \"Original\" = \"original_estimate\", \n         \"Removed Gaps\" = \"gaps_removed_estimate\",\n         \"Removed Ends \" = \"end_removed_estimate\", \n         \"Removed All\" = \"all_removed_estimate\")\n\nwb <- createWorkbook()\naddWorksheet(wb, \"Supplemental Table 1\")\nwriteData(wb, 1, t)\nbold <- createStyle(textDecoration = \"bold\")\npval <- createStyle(halign = \"left\", numFmt = \"(P = 0.000)\")\nest <- createStyle(halign = \"right\", numFmt = \"0.000\")\nfor(c in c(3, 5, 7, 9)) {\n  conditionalFormatting(wb, 1, cols = c, rows = 1:15, rule = \"<=0.05\", style = bold)\n  addStyle(wb, 1, cols = c, rows = 1:15, style = pval, stack = TRUE)\n}\nfor(c in c(2, 4, 6, 8)) {\n  addStyle(wb, 1, cols = c, rows = 1:15, style = est, stack = TRUE)\n}\nmergeCells(wb, 1, cols = 2:3, rows = 1)\nmergeCells(wb, 1, cols = 4:5, rows = 1)\nmergeCells(wb, 1, cols = 6:7, rows = 1)\nmergeCells(wb, 1, cols = 8:9, rows = 1)\naddStyle(wb, 1, cols = 1:9, rows = 1, \n         style = createStyle(halign = \"center\", textDecoration = \"bold\"),\n         stack = TRUE)\nsetColWidths(wb, 1, cols = 1:9, widths = 10)\nsetColWidths(wb, 1, cols = 1, widths = 20)\n\nsetRowHeights(wb, 1, rows = nrow(t) + 3, heights = 100)\nwriteData(\n  wb, 1, startCol = 1, startRow = nrow(t) + 3, \n  x = paste0(\n    \"Table. Results [Estimate of Year (P-value)] for different models when removing selective years. \\n\",\n    \"'Original' represents the results for the original model;\\n\",\n    \"'Removed Gaps' represents the results for these models when removing years with large gaps around the migration peaks (1998, 2011, 2013);\\n\",\n    \"'Removed Ends' represents the results for these models when removing years where it looks like sampling ended earlier than the end of migration (2001, 2006, 2023);\\n\",\n    \"'Removed All' represents the results for these models when removing all questionable years (1998, 2001, 2006, 2011, 2013, 2023)\\n\",\n    \"Bold P values are significant at P <= 0.05.\"\n    ))\n\nsaveWorkbook(wb, \"Data/table_supp.xlsx\", overwrite = TRUE)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}